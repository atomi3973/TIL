# 取り組んだこと
- Next.js Rails環境構築

# 学んだこと
## Docker・Docker Compose 関連
- EXPOSE 3000
Dockerfile 内でコンテナのポートを公開する宣言. 
実際のポートマッピングは Compose で指定する必要がある

- Dockerfile CMD と docker-compose command
CMD はデフォルトコマンド. 
Compose の command: が優先される

- env_file と .env
env_file で環境変数をコンテナに渡す. 
Rails 内では ENV['VAR_NAME'] で参照可能. 
dotenv-rails は開発環境で同様に .env を読み込む

- PostgreSQL 環境変数
POSTGRES_USER, POSTGRES_PASSWORD, POSTGRES_DB で初期ユーザー・DB作成. 
POSTGRES_HOST_AUTH_METHOD: md5 で MD5 パスワード認証を有効化. 
この設定だけで pg_hba.conf を編集せず認証方式が設定される

- DB 待機スクリプト
DB が起動するまでループして待機. 
Rails サーバー起動前に必須
```
until pg_isready -h db -p 5432 -U postgres; do
  echo 'Waiting for PostgreSQL...'
  sleep 2
done
```

## git gitignore
- backendとfrontendフォルダを作成した場合、親にgit環境を作成してまとめた方がいい
- それぞれのフォルダにgitignoreを作成しても無視される
- そのため親フォルダにgitignoreをまとめて作成する必要がある(そのときはパスに注意)

# コメント
なんとか環境構築完了。色々と学んだ。けど結構理解できて来たので楽しい。次は本番デプロイ、認証機能実装にチャレンジ!!